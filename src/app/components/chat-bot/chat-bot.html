<!-- Chat Bot Toggle Button -->
<div class="chat-bot-toggle" [class.open]="isOpen" (click)="toggleChat()">
  <svg
    *ngIf="!isOpen"
    width="24"
    height="24"
    viewBox="0 0 24 24"
    fill="none"
    stroke="currentColor"
    stroke-width="2"
  >
    <path
      d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2v10z"
    />
  </svg>
  <svg
    *ngIf="isOpen"
    width="24"
    height="24"
    viewBox="0 0 24 24"
    fill="none"
    stroke="currentColor"
    stroke-width="2"
  >
    <line x1="18" y1="6" x2="6" y2="18"></line>
    <line x1="6" y1="6" x2="18" y2="18"></line>
  </svg>
</div>

<!-- Chat Bot Window -->
<div class="chat-bot-window" [class.open]="isOpen">
  <!-- Chat Header -->
  <div class="chat-header">
    <div class="header-info">
      <div class="bot-avatar">ðŸ¤–</div>
      <div class="bot-details">
        <h3>Travel Assistant</h3>
        <span class="status">Ready to help</span>
      </div>
    </div>
    <div class="header-actions">
      <button class="clear-btn" (click)="clearChat()" title="Clear Chat">
        <svg
          width="16"
          height="16"
          viewBox="0 0 24 24"
          fill="none"
          stroke="currentColor"
          stroke-width="2"
        >
          <polyline points="3,6 5,6 21,6"></polyline>
          <path
            d="m19,6v14a2,2 0 0,1 -2,2H7a2,2 0 0,1 -2,-2V6m3,0V4a2,2 0 0,1 2,-2h4a2,2 0 0,1 2,2v2"
          ></path>
        </svg>
      </button>
      <button class="close-btn" (click)="closeChat()" title="Close Chat">
        <svg
          width="16"
          height="16"
          viewBox="0 0 24 24"
          fill="none"
          stroke="currentColor"
          stroke-width="2"
        >
          <line x1="18" y1="6" x2="6" y2="18"></line>
          <line x1="6" y1="6" x2="18" y2="18"></line>
        </svg>
      </button>
    </div>
  </div>

  <!-- Chat Messages -->
  <div class="chat-messages">
    <!-- Quick Action Buttons -->
    <div *ngIf="showQuickActions && messages.length <= 1" class="quick-actions">
      <p class="quick-actions-title">Quick help with:</p>
      <div class="quick-actions-grid">
        <button
          *ngFor="let action of quickActions"
          class="quick-action-btn"
          (click)="handleQuickAction(action.action)"
        >
          {{ action.text }}
        </button>
      </div>
    </div>

    <div
      *ngFor="let message of messages"
      class="message"
      [ngClass]="message.role"
    >
      <!-- <div class="message-content">
          {{ message.content }}
        </div> -->
      <div class="message-content" [innerHTML]="message.content"></div>

      <div class="message-time">
        {{ message.timestamp | date:'short' }}
      </div>
    </div>

    <!-- Loading indicator -->
    <div *ngIf="isLoading" class="message assistant">
      <div class="message-content">
        <div class="typing-indicator">
          <span></span>
          <span></span>
          <span></span>
        </div>
      </div>
    </div>
  </div>

  <!-- Chat Input -->
  <div class="chat-input-container">
    <div class="input-wrapper">
      <input
        type="text"
        [(ngModel)]="userInput"
        (keypress)="onKeyPress($event)"
        placeholder="Ask about places to stay, or travel..."
        class="chat-input"
        [disabled]="isLoading"
      />
      <button
        (click)="sendMessage()"
        class="send-btn"
        [disabled]="!userInput.trim() || isLoading"
      >
        <svg
          width="20"
          height="20"
          viewBox="0 0 24 24"
          fill="none"
          stroke="currentColor"
          stroke-width="2"
        >
          <line x1="22" y1="2" x2="11" y2="13"></line>
          <polygon points="22,2 15,22 11,13 2,9 22,2"></polygon>
        </svg>
      </button>
    </div>
  </div>
</div>

<!-- Backdrop -->
<div *ngIf="isOpen" class="chat-backdrop" (click)="closeChat()"></div>
